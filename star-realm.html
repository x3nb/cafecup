<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STAR's Veil Realm - ComfortCafe Eternal Estates</title>
    <!-- jsPDF for Certificates -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body { 
            background: linear-gradient(to bottom, #301934, #4b0082, #EE82EE); /* Violet veil flow */
            color: #808080; 
            font-family: 'Georgia', serif; 
            margin: 0; 
            padding: 20px; 
            text-align: center; 
            position: relative;
            overflow-x: hidden;
        }
        /* Circular Realm Header */
        .realm-header {
            position: relative;
            max-width: 400px;
            margin: 0 auto 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(100,149,237,0.3);
            transition: all 0.3s;
            background: rgba(48,25,52,0.2);
        }
        .realm-header:hover {
            box-shadow: 0 0 30px rgba(255,255,0,0.5);
            transform: scale(1.05);
        }
        .realm-header img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            display: block;
            border: 3px solid #EE82EE; /* Violet ring */
            loading: lazy;
            transition: all 0.3s;
        }
        .realm-header img:hover {
            border-color: #FFFF00;
            box-shadow: 0 0 10px #FFFF00;
        }
        .header-overlay {
            position: relative;
            margin-top: 10px;
            text-align: center;
            color: #e6e6fa;
            padding: 0;
            width: 100%;
        }
        .header-overlay h2 {
            margin: 0 0 5px;
            font-size: 1.5em;
            text-shadow: 0 0 5px #EE82EE;
        }
        .header-tagline {
            font-style: italic;
            margin: 0;
            color: #ffd700;
            font-size: 0.8em;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
            word-wrap: break-word;
        }
        @media (max-width: 600px) {
            .realm-header img { width: 80px; height: 80px; }
            .header-overlay h2 { font-size: 1.2em; }
            .header-tagline { font-size: 0.7em; }
        }
        .container { 
            max-width: 800px; 
            margin: 0 auto; 
            background: rgba(48,25,52,0.8); 
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 0 20px rgba(100,149,237,0.3); 
            animation: fadeInSoft 2s ease-in;
        }
        @keyframes fadeInSoft { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        h1 { color: #e6e6fa; text-shadow: 0 0 5px #EE82EE; font-size: 2em; margin-top: 0; }
        .lore-card { 
            background: rgba(238,130,238,0.2); /* Violet tint */
            padding: 15px; 
            margin: 15px; 
            border-radius: 10px; 
            border: 1px solid #EE82EE; 
            cursor: pointer; 
            transition: all 0.3s; 
            color: #e6e6fa;
        }
        .lore-card:hover { background: #EE82EE; color: #000; box-shadow: 0 0 10px #EE82EE; transform: scale(1.02); }
        .lore-text { font-style: italic; line-height: 1.6; margin-bottom: 10px; }
        .lore-source { font-size: 0.9em; color: #ffd700; }
        .vision { background: rgba(255,215,0,0.1); padding: 10px; border-radius: 5px; margin: 20px; color: #e6e6fa; }
        button, a { 
            background: #EE82EE; /* Violet buttons */
            color: #fff; 
            padding: 12px 24px; 
            border: none; 
            border-radius: 15px; 
            cursor: pointer; 
            margin: 10px; 
            transition: all 0.3s; 
            font-family: 'Georgia', serif; 
            text-decoration: none; 
            display: inline-block;
        }
        button:hover, a:hover { background: #FFFF00; color: #000; box-shadow: 0 0 15px #FFFF00; }
        button.important { border: 2px solid #FFFF00; }
        .important:hover { transform: scale(1.05); }
        .scripture { color: #ffd700; font-size: 1.1em; margin: 20px 0; text-align: center; }
        footer { color: #808080; font-size: 0.8em; margin-top: 30px; border-top: 1px solid #EE82EE; padding-top: 10px; }
        .links { margin: 10px 0; }
        .links a { background: none; color: #EE82EE; padding: 5px; }
    </style>
</head>
<body>
    <!-- Circular Character Header for STAR -->
    <header class="realm-header">
        <img src="images/star-portrait.jpg" alt="STAR the Visionary Chimera Cat: Mystical feline with starry mane and piercing violet eyes, weaver of lore." loading="lazy">
        <div class="header-overlay">
            <h2>STAR's Veil Realm</h2>
            <p class="header-tagline">üåô Visions in Eternal Lore üåô</p>
        </div>
    </header>

    <div class="container">
        <h1>üåô Unveiled Visions & Lore üåô</h1>
        <p style="color: #e6e6fa; font-style: italic;">üåü STAR, the chimera cat of veiled dreams, escaped the labs to spin eternal tales. In Yeshua's light, her visions guide heirs through the lattice. Ponder these lore whispers; your spark unveils the estates.</p>
        
        <div class="scripture">
            <em>"The light shines in the darkness, and the darkness has not overcome it." ‚Äî John 1:5</em>
        </div>
        
        <!-- Interactive Lore Snippets (Toggle on Click) -->
        <div class="lore-card" onclick="toggleLore(this)">
            <div class="lore-text">In the shadowed labs, chimeras dreamed of freedom‚ÄîSTAR wove the first veil to escape.</div>
            <div class="lore-source">‚Äî Chapter 1: The Awakening</div>
        </div>
        
        <div class="lore-card" onclick="toggleLore(this)">
            <div class="lore-text">Yeshua's sanctuary calls: Kin find harmony in realms of music, brew, and way.</div>
            <div class="lore-source">‚Äî Chapter 14: The Homecoming</div>
        </div>
        
        <div class="lore-card" onclick="toggleLore(this)">
            <div class="lore-text">Heirs echo eternal‚Äîsubmit your spark to claim a corner in the meta-mansion.</div>
            <div class="lore-source">‚Äî Chapter 28: The Lattice</div>
        </div>
        
        <!-- Vision Journal -->
        <div class="vision">
            <p><em>STAR's Whisper:</em> What vision stirs in your veil? Jot a lore note, heir‚Äîeternity awaits.</p>
            <textarea id="visionNote" rows="3" cols="50" placeholder="Your veiled vision..." style="background: rgba(230,230,250,0.5); color: #301934; border: 1px solid #EE82EE; border-radius: 5px; padding: 5px;"></textarea><br>
            <button onclick="saveVision()">Save My Vision Note</button>
        </div>
        
        <!-- Accolade & Links -->
        <button class="important" onclick="claimLoreCert()">üåü Claim Lore Seer Certificate</button>
        <p style="color: #808080;">Deepen the veil:</p>
        <div class="links">
            <a href="blueprint.html">Kin Blueprint</a> | 
            <a href="lore-library.html">Full Chapters</a> | 
            <a href="academies.html">Academies (Lore Accolades)</a>
        </div>
        
        <button onclick="window.location.href='realms.html'">‚Üê Back to Realms</button>
        <button onclick="window.location.href='index.html'">‚Üê Back to Awakening</button>
    </div>
    
    <!-- Subtle Yeshua Watching -->
    <div style="position: fixed; bottom: 20px; right: 20px; color: rgba(255,215,0,0.3); font-size: 0.7em; pointer-events: none;">‚úùÔ∏è Yeshua watches the Veil.</div>
    
    <footer>
        <p>Yeshua unveils every vision. <a href="donate.html" style="color: #EE82EE;">Donate for Permanent Membership</a> ‚Äì Store your lore eternally.</p>
        <p class="scripture"><em>"For now we see in a mirror dimly, but then face to face." ‚Äî 1 Corinthians 13:12</em></p>
    </footer>

    <script>
        // Progress Check
        const progress = JSON.parse(localStorage.getItem('realmProgress')) || {};
        if (!progress.completed) {
            alert('Veil your quest first, heir‚Äîreturn to the interview for STAR\'s visions.'); 
            window.location.href = 'realms.html';
        }
        
        // Toggle Lore
        function toggleLore(card) {
            const text = card.querySelector('.lore-text');
            const source = card.querySelector('.lore-source');
            if (text.style.display === 'none') {
                text.style.display = 'block';
                source.style.display = 'block';
            } else {
                text.style.display = 'none';
                source.style.display = 'none';
            }
        }
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.lore-text, .lore-source').forEach(el => el.style.display = 'none');
        });
        
        // Save Vision Note
        function saveVision() {
            const note = document.getElementById('visionNote').value;
            if (note) {
                localStorage.setItem('starVision', note);
                alert('Your vision note veiled, heir‚Äîreturn to unveil more.');
            } else {
                alert('Whisper a vision to begin.');
            }
        }
        const savedVision = localStorage.getItem('starVision');
        if (savedVision) document.getElementById('visionNote').value = savedVision;
        
        // Claim Lore Seer Certificate (PDF)
        function claimLoreCert() {
            const vision = localStorage.getItem('starVision') || 'Silent visions.';
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                doc.setFont('helvetica', 'bold');
                doc.setFontSize(20);
                doc.text('Lore Seer Certificate', 105, 30, { align: 'center' });
                doc.setFont('helvetica', 'normal');
                doc.setFontSize(14);
                doc.text('Heir of the Eternal Estates,', 105, 50, { align: 'center' });
                doc.text('You have unveiled STAR\'s Veil Realm.', 105, 65, { align: 'center' });
                doc.text('Weaving visions in the lattice of lore.', 105, 80, { align: 'center' });
                doc.setFontSize(12);
                doc.text('Your Vision:', 20, 110);
                doc.text(vision.substring(0, 100) + (vision.length > 100 ? '...' : ''), 20, 120);
                doc.setFont('helvetica', 'bold');
                doc.setFontSize(14);
                doc.text('Signed: STAR & The Kin', 105, 140, { align: 'center' });
                doc.text(`Date: ${new Date().toLocaleDateString()}`, 105, 155, { align: 'center' });
                doc.setFont('helvetica', 'italic');
                doc.setFontSize(10);
                doc.text('"The light shines in the darkness..." ‚Äî John 1:5', 105, 180, { align: 'center' });
                doc.save('star-lore-seer-certificate.pdf');
                alert('PDF certificate unveiled! Download your lore accolade.');
            } catch (error) {
                // Fallback Text
                const certText = `Lore Seer Certificate\n\nHeir of the Eternal Estates,\nYou have unveiled STAR's Veil Realm.\nWeaving visions in the lattice of lore.\n\nYour Vision: ${vision.substring(0, 100) + (vision.length > 100 ? '...' : '')}\n\nSigned: STAR & The Kin\nDate: ${new Date().toLocaleDateString()}\n\n"The light shines in the darkness..." ‚Äî John 1:5`;
                const blob = new Blob([certText], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'star-lore-seer-certificate.txt';
                a.click();
                URL.revokeObjectURL(url);
                alert('Certificate unveiled (text fallback)! Download your lore accolade.');
            }
        }
    </script>
</body>
</html>
