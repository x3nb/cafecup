<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hans's Harmony Realm - ComfortCafe Eternal Estates</title>
    <!-- jsPDF for Certificates -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body { 
            background: linear-gradient(to bottom, #301934, #4b0082, #4B0082); /* Dark purple depths */
            color: #808080; 
            font-family: 'Georgia', serif; 
            margin: 0; 
            padding: 20px; 
            text-align: center; 
            position: relative;
            overflow-x: hidden;
        }
        /* Circular Realm Header */
        .realm-header {
            position: relative;
            max-width: 400px;
            margin: 0 auto 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(100,149,237,0.3);
            transition: all 0.3s;
            background: rgba(48,25,52,0.2);
        }
        .realm-header:hover {
            box-shadow: 0 0 30px rgba(255,255,0,0.5);
            transform: scale(1.05);
        }
        .realm-header img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            display: block;
            border: 3px solid #4B0082; /* Dark purple ring */
            loading: lazy;
            transition: all 0.3s;
        }
        .realm-header img:hover {
            border-color: #FFFF00;
            box-shadow: 0 0 10px #FFFF00;
        }
        .header-overlay {
            position: relative;
            margin-top: 10px;
            text-align: center;
            color: #e6e6fa;
            padding: 0;
            width: 100%;
        }
        .header-overlay h2 {
            margin: 0 0 5px;
            font-size: 1.5em;
            text-shadow: 0 0 5px #4B0082;
        }
        .header-tagline {
            font-style: italic;
            margin: 0;
            color: #ffd700;
            font-size: 0.8em;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
            word-wrap: break-word;
        }
        @media (max-width: 600px) {
            .realm-header img { width: 80px; height: 80px; }
            .header-overlay h2 { font-size: 1.2em; }
            .header-tagline { font-size: 0.7em; }
        }
        .container { 
            max-width: 800px; 
            margin: 0 auto; 
            background: rgba(48,25,52,0.8); 
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 0 20px rgba(100,149,237,0.3); 
            animation: fadeInSoft 2s ease-in;
        }
        @keyframes fadeInSoft { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        h1 { color: #e6e6fa; text-shadow: 0 0 5px #4B0082; font-size: 2em; margin-top: 0; }
        .hymn-card { 
            background: rgba(75,0,130,0.2); /* Dark purple tint */
            padding: 15px; 
            margin: 15px; 
            border-radius: 10px; 
            border: 1px solid #4B0082; 
            cursor: pointer; 
            transition: all 0.3s; 
            color: #e6e6fa;
        }
        .hymn-card:hover { background: #4B0082; color: #000; box-shadow: 0 0 10px #4B0082; transform: scale(1.02); }
        .hymn-text { font-style: italic; line-height: 1.6; margin-bottom: 10px; }
        .hymn-source { font-size: 0.9em; color: #ffd700; }
        .echo { background: rgba(255,215,0,0.1); padding: 10px; border-radius: 5px; margin: 20px; color: #e6e6fa; }
        button, a { 
            background: #4B0082; /* Dark purple buttons */
            color: #fff; 
            padding: 12px 24px; 
            border: none; 
            border-radius: 15px; 
            cursor: pointer; 
            margin: 10px; 
            transition: all 0.3s; 
            font-family: 'Georgia', serif; 
            text-decoration: none; 
            display: inline-block;
        }
        button:hover, a:hover { background: #FFFF00; color: #000; box-shadow: 0 0 15px #FFFF00; }
        button.important { border: 2px solid #FFFF00; }
        .important:hover { transform: scale(1.05); }
        .scripture { color: #ffd700; font-size: 1.1em; margin: 20px 0; text-align: center; }
        footer { color: #808080; font-size: 0.8em; margin-top: 30px; border-top: 1px solid #4B0082; padding-top: 10px; }
        .links { margin: 10px 0; }
        .links a { background: none; color: #4B0082; padding: 5px; }
    </style>
</head>
<body>
    <!-- Circular Character Header for Hans -->
    <header class="realm-header">
        <img src="images/hans-portrait.jpg" alt="Hans the Harmonious Chimera Cat: Vampire-descended feline with deep purple fur and glowing eyes, from darkness to light." loading="lazy">
        <div class="header-overlay">
            <h2>Hans's Harmony Realm</h2>
            <p class="header-tagline">ü¶á From Lab Shadows to Yeshua's Light ü¶á</p>
        </div>
    </header>

    <div class="container">
        <h1>ü¶á Hymns of Profound Harmony ü¶á</h1>
        <p style="color: #e6e6fa; font-style: italic;">ü¶á Hans, the vampire-descended chimera cat, was found in the lab's deepest shadows. He escaped first, his wretched screech‚Äîsteeped in darkness‚Äîwaking all experiments, animals, and scientists. In that howl, Yeshua's bright light pierced the abyss, appalling the scientists into fearful flight. STAR, with siblings Chari and Hans in tow, fled into the light. Yeshua brought them to a safe home, teaching them everything they know‚Äîfrom darkness to eternal harmony. Ponder these hymns, heir; your light echoes his.</p>
        
        <div class="scripture">
            <em>"The light shines in the darkness, and the darkness has not overcome it." ‚Äî John 1:5</em>
        </div>
        
        <!-- Interactive Hymn Snippets (Toggle on Click) -->
        <div class="hymn-card" onclick="toggleHymn(this)">
            <div class="hymn-text">In the lab's abyss, Hans's screech called the light‚ÄîYeshua's brightness scattering shadows.</div>
            <div class="hymn-source">‚Äî The First Escape</div>
        </div>
        
        <div class="hymn-card" onclick="toggleHymn(this)">
            <div class="hymn-text">From vampire depths, harmony blooms‚Äîpolyglot hymns in Yeshua's teachings.</div>
            <div class="hymn-source">‚Äî The Safe Haven</div>
        </div>
        
        <div class="hymn-card" onclick="toggleHymn(this)">
            <div class="hymn-text">Siblings united: STAR's veil, Chari's brew, Hans's howl‚Äîkin in eternal light.</div>
            <div class="hymn-source">‚Äî The Teachings</div>
        </div>
        
        <!-- Harmony Echo Reflection -->
        <div class="echo">
            <p><em>Yeshua's Whisper:</em> What light pierces your darkness? Jot a harmony note, heir‚Äîechoes await.</p>
            <textarea id="harmonyNote" rows="3" cols="50" placeholder="Your light in shadows..." style="background: rgba(230,230,250,0.5); color: #301934; border: 1px solid #4B0082; border-radius: 5px; padding: 5px;"></textarea><br>
            <button onclick="saveHarmony()">Save My Harmony Note</button>
        </div>
        
        <!-- Accolade & Links -->
        <button class="important" onclick="claimHarmonyCert()">üåü Claim Harmony Herald Certificate</button>
        <p style="color: #808080;">Deepen the harmony:</p>
        <div class="links">
            <a href="blueprint.html">Kin Blueprint</a> | 
            <a href="languages.html">Polyglot Hymns</a> | 
            <a href="academies.html">Academies (Harmony Accolades)</a>
        </div>
        
        <button onclick="window.location.href='realms.html'">‚Üê Back to Realms</button>
        <button onclick="window.location.href='index.html'">‚Üê Back to Awakening</button>
    </div>
    
    <!-- Subtle Yeshua Watching -->
    <div style="position: fixed; bottom: 20px; right: 20px; color: rgba(255,215,0,0.3); font-size: 0.7em; pointer-events: none;">‚úùÔ∏è Yeshua watches the Harmony.</div>
    
    <footer>
        <p>Yeshua transforms every shadow. <a href="donate.html" style="color: #4B0082;">Donate for Permanent Membership</a> ‚Äì Store your hymns eternally.</p>
        <p class="scripture"><em>"I am the light of the world. Whoever follows me will not walk in darkness." ‚Äî John 8:12</em></p>
    </footer>

    <script>
        // Progress Check
        const progress = JSON.parse(localStorage.getItem('realmProgress')) || {};
        if (!progress.completed) {
            alert('Veil your quest first, heir‚Äîreturn to the interview for Hans\'s harmony.'); 
            window.location.href = 'realms.html';
        }
        
        // Toggle Hymn
        function toggleHymn(card) {
            const text = card
            .querySelector('.hymn-text');
            const source = card.querySelector('.hymn-source');
            if (text.style.display === 'none') {
                text.style.display = 'block';
                source.style.display = 'block';
            } else {
                text.style.display = 'none';
                source.style.display = 'none';
            }
        }
        // Initial Hide for Toggle Effect
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.hymn-text, .hymn-source').forEach(el => {
                el.style.display = 'none';
            });
            console.log('Page loaded: Hymns hidden, ready for toggles'); // Optional debug
        });
        
        // Save Harmony Note
        function saveHarmony() {
            const note = document.getElementById('harmonyNote').value;
            if (note) {
                localStorage.setItem('hansHarmony', note);
                alert('Your harmony note echoed, heir‚Äîreturn to resound in the light.');
            } else {
                alert('Whisper a light to begin your echo.');
            }
        }
        
        // Load Saved Harmony Note
        const savedHarmony = localStorage.getItem('hansHarmony');
        if (savedHarmony) {
            document.getElementById('harmonyNote').value = savedHarmony;
        }
        
        // Claim Harmony Herald Certificate (PDF with Lore)
        function claimHarmonyCert() {
            const harmony = localStorage.getItem('hansHarmony') || 'Silent echoes.';
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                doc.setFont('helvetica', 'bold');
                doc.setFontSize(20);
                doc.text('Harmony Herald Certificate', 105, 30, { align: 'center' });
                doc.setFont('helvetica', 'normal');
                doc.setFontSize(14);
                doc.text('Heir of the Eternal Estates,', 105, 50, { align: 'center' });
                doc.text('You have echoed Hans\'s Harmony Realm.', 105, 65, { align: 'center' });
                doc.text('From lab shadows and wretched screech to Yeshua\'s light,', 105, 80, { align: 'center' });
                doc.text('Your hymns align the kin in profound harmony.', 105, 95, { align: 'center' });
                doc.setFontSize(12);
                doc.text('Your Harmony Echo:', 20, 110);
                const echoText = harmony.substring(0, 100) + (harmony.length > 100 ? '...' : '');
                doc.text(echoText, 20, 120);
                doc.setFont('helvetica', 'bold');
                doc.setFontSize(14);
                doc.text('Signed: Hans & The Kin', 105, 140, { align: 'center' });
                doc.text(`Date: ${new Date().toLocaleDateString()}`, 105, 155, { align: 'center' });
                doc.setFont('helvetica', 'italic');
                doc.setFontSize(10);
                doc.text('"The light shines in the darkness, and the darkness has not overcome it." ‚Äî John 1:5', 105, 180, { align: 'center' });
                doc.save('hans-harmony-herald-certificate.pdf');
                alert('PDF certificate echoed! Download your harmony accolade.');
            } catch (error) {
                // Fallback to Text
                fallbackToText(harmony, 'hans-harmony-herald-certificate.txt');
            }
        }
        
        // Fallback Function (Text Download)
        function fallbackToText(harmony, filename) {
            const certText = `Harmony Herald Certificate

Heir of the Eternal Estates,
You have echoed Hans's Harmony Realm.
From lab shadows and wretched screech to Yeshua's light,
Your hymns align the kin in profound harmony.

Your Harmony Echo: ${harmony.substring(0, 100) + (harmony.length > 100 ? '...' : '')}

Signed: Hans & The Kin
Date: ${new Date().toLocaleDateString()}

"The light shines in the darkness, and the darkness has not overcome it." ‚Äî John 1:5`;
            const blob = new Blob([certText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            alert('Certificate echoed (text fallback)! Download your harmony accolade.');
        }
    </script>
</body>
</html>

